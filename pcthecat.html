<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>MushRush — Early Access (Polished)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-900:#05020a;
    --panel:#0b0910;
    --muted:rgba(255,255,255,0.92);
    --muted-2:rgba(255,255,255,0.62);
    --purple-800:#3b0f78;
    --purple-700:#5b21a6;
    --purple-500:#8b5cf6;
    --purple-300:#c6a6ff;
    --accent:#ff6fcf;
    --success:#22c55e;
    --glass:rgba(255,255,255,0.04);
    --card-radius:14px;
    --shadow-lg: 0 20px 50px rgba(6,8,20,0.7);
    --focus: rgba(139,92,246,0.16);
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#03010a 0%, #06020b 100%);color:#eef2ff;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;overflow:hidden}
  body::before{content:'';position:fixed;inset:0;background-image:radial-gradient(rgba(255,255,255,0.004) 1px, transparent 1px);background-size:8px 8px;mix-blend-mode:overlay;opacity:.6;pointer-events:none}

  /* design canvas auto-fit */
  .stage-wrap{width:1280px;height:760px;margin:0 auto;transform-origin:top center;display:flex;align-items:center;justify-content:center}
  .stage{width:1240px;height:720px;padding:22px;box-sizing:border-box;display:grid;grid-template-columns:1fr 480px;gap:28px;border-radius:18px;background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));border:1px solid var(--glass);box-shadow:var(--shadow-lg)}

  /* LEFT column */
  .left{display:flex;flex-direction:column;gap:14px;padding:10px}
  .header{display:flex;align-items:center;gap:12px}
  .logo{width:56px;height:46px;border-radius:12px;background:linear-gradient(135deg,var(--purple-700),var(--purple-500));display:flex;align-items:center;justify-content:center;font-weight:800}
  .title{font-weight:700}
  .subtitle{font-size:13px;color:var(--muted-2)}

  .h1{font-family:Space Mono,monospace;font-weight:800;letter-spacing:1px;color:var(--purple-300);font-size:28px}
  .lead{color:var(--muted);max-width:640px}

  .ref-block{display:flex;flex-direction:column;gap:8px;margin-top:8px}
  .ref-required{color:var(--muted-2);font-size:13px}
  .input-row{display:flex;gap:10px;align-items:center}
  .input{flex:1;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-weight:600}
  .btn-apply{padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--purple-700),var(--purple-500));color:white;font-weight:800;cursor:pointer}

  /* TASKS area (left) */
  .tasks{margin-top:12px;display:flex;flex-direction:column;gap:12px}
  .task-row{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.012), transparent);border:1px solid rgba(255,255,255,0.02)}
  .task-left{display:flex;align-items:center;gap:12px}
  .task-dot{width:14px;height:14px;border-radius:50%;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.03)}
  .task-dot.task-done{background:var(--success);border-color:rgba(0,0,0,0.06)}
  .task-label{font-weight:700}

  /* PURPLE task buttons (unified) */
  .btn-task{padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--purple-700),var(--purple-500));color:white;font-weight:800;cursor:pointer;box-shadow:0 8px 20px rgba(91,33,166,0.12)}
  .btn-task.small{padding:8px 12px;font-weight:700}
  .btn-task.done{background:linear-gradient(90deg,#22c55e,#7ee6a6);box-shadow:0 8px 20px rgba(34,197,94,0.12);color:#04220f}

  .progress{margin-top:6px;text-align:left;color:var(--muted);font-weight:700}

  /* MAIN CTA styles (distinct but cohesive) */
  .cta-row{display:flex;gap:12px;margin-top:8px}
  .btn-cta-primary{padding:12px 16px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--purple-700),var(--purple-300));color:white;font-weight:900;cursor:pointer;box-shadow:0 14px 36px rgba(91,33,166,0.12)}
  .btn-cta-primary[disabled]{opacity:.5;cursor:not-allowed}
  .btn-cta-secondary{padding:12px 16px;border-radius:12px;border:2px solid rgba(255,255,255,0.06);background:transparent;color:var(--purple-300);font-weight:900;cursor:pointer}

  /* RIGHT column: player card with image container like screenshot */
  .right{display:flex;flex-direction:column;gap:12px}
  .card{border-radius:14px;padding:14px;background:linear-gradient(180deg, rgba(139,92,246,0.06), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.04);box-shadow:0 20px 50px rgba(6,8,20,0.6)}

  /* image container: rounded rectangle with large inset padding and subtle inset shadow (like screenshot) */
  .image-frame{border-radius:14px;overflow:hidden;background:linear-gradient(180deg, var(--purple-300), var(--purple-500));padding:18px;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 -18px 30px rgba(0,0,0,0.18), 0 12px 36px rgba(10,6,25,0.6)}
  .image-card{width:100%;max-width:420px;border-radius:12px;background:#fff;padding:6px;box-shadow:0 18px 40px rgba(16,10,30,0.6);}
  .image-card img{display:block;width:100%;height:auto;border-radius:8px}

  .card-meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
  .meta-left{color:var(--muted-2);font-weight:700}
  .status{font-weight:900;color:white}

  .card-tasks{margin-top:12px;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}
  .card-tasks .task-row{background:transparent;border:0;padding:10px}

  /* small helpers */
  .muted{color:var(--muted)}
  .hint{font-size:13px;color:var(--muted-2)}

  button:focus,input:focus{outline:none;box-shadow:0 0 0 6px var(--focus);border-radius:10px}

  /* Close & Download variants (keeps consistency with theme) */
.icon-btn {
  width:42px;
  height:42px;
  border-radius:10px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.04);
  color: #fff;
  cursor:pointer;
  transition: transform .14s ease, box-shadow .14s ease, background .12s ease;
}
.icon-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 30px rgba(6,10,30,0.45); }
.icon-btn:active { transform: translateY(-1px); }
.icon-btn:focus { outline: none; box-shadow: 0 0 0 6px rgba(139,92,246,0.12); }

/* Close button: red-ish hint */
.icon-btn.close {
  background: linear-gradient(180deg, rgba(255,80,80,0.06), rgba(255,40,40,0.02));
  border-color: rgba(255,80,80,0.10);
  color: #fff;
}

/* Download button: purple solid */
.icon-btn.download {
  background: linear-gradient(90deg, #5b21a6, #8b5cf6);
  border: 0;
  color: #fff;
  box-shadow: 0 10px 28px rgba(91,33,166,0.14);
}
.icon-btn svg { width:18px; height:18px; display:block; fill: currentColor; stroke: currentColor; }

/* overlay & toast & confetti */
.overlay {
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(1,1,2,0.6), rgba(1,1,2,0.75));backdrop-filter:blur(6px);z-index:60;
}
.overlay-card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));padding:22px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 30px 80px rgba(6,8,20,0.6);min-width:320px;color:var(--muted)}
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:36px;background:linear-gradient(90deg, rgba(0,0,0,0.45), rgba(0,0,0,0.35));padding:10px 14px;border-radius:10px;color:white;z-index:70;opacity:0;transition:opacity .18s ease}
.confetti-canvas{position:fixed;inset:0;pointer-events:none;z-index:75}

/* small responsive fallback */
@media (max-width:1220px){
  .stage{width:100%;height:auto;grid-template-columns:1fr;gap:18px}
  .stage-wrap{width:100%}
  body{overflow:auto}
}
</style>
</head>
<body>
  <div id="stageWrap" class="stage-wrap" aria-hidden="false">
    <div id="stage" class="stage" role="region" aria-label="MushRush early access">

      <div class="left panel">
        <div class="header">
          <div class="logo" aria-hidden="true">M</div>
          <div>
            <div class="title">MushRush — Early Access</div>
            <div class="subtitle">Marketing landing • Share to climb the queue</div>
          </div>
          <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
            <button class="btn-task small" id="copyRef" title="Copy referral address">Copy ref</button>
          </div>
        </div>

        <div>
          <div class="h1">GET EARLY ACCESS</div>
          <div class="lead" style="margin-top:8px">We’re building MushRush — a farming + item-drop on-chain experience. Complete a few simple tasks and share your referral to move up the early access queue.</div>
        </div>

        <div class="ref-block">
          <div class="ref-required">Referral code/address is <strong>required</strong> to register</div>
          <div class="input-row">
            <input id="useRef" class="input" placeholder="Enter referral code or wallet address (required)" maxlength="80" aria-label="Referral code or address" />
            <button id="applyRef" class="btn-apply" title="Apply referral">Apply</button>
          </div>
          <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
            <div class="hint">Your referral:</div>
            <div style="font-weight:800;color:var(--purple-300)" id="myRefShort">RF-XXXX</div>
            <div class="hint" style="margin-left:6px;color:var(--muted-2)" id="myFullRef">0x...hidden</div>
          </div>
        </div>

        <div class="tasks" id="tasks">
           <div class="task-row" data-task="discord">
            <div class="task-left"><span class="task-dot" id="dot-discord"></span><div class="task-label">Join our Discord</div></div>
            <div><button class="btn-task" id="task-discord">Join</button></div>
          </div>

          <div class="task-row" data-task="share">
            <div class="task-left"><span class="task-dot" id="dot-share"></span><div class="task-label">Share your referral card</div></div>
            <div><button class="btn-task" id="task-share">Share</button></div>
          </div>

           <div class="task-row" data-task="follow">
            <div class="task-left"><span class="task-dot" id="dot-follow"></span><div class="task-label">Follow us on X</div></div>
            <div><button class="btn-task" id="task-follow">Follow</button></div>
          </div>

          <div class="progress" id="progressText">0 / 3 tasks completed</div>
        </div>

        <div class="cta-row">
          <button id="registerBtn" class="btn-cta-primary" disabled>Register for Early Access</button>
          <button id="sharePrimary" class="btn-cta-secondary">Share on X</button>
        </div>
      </div>

      <div class="right" aria-live="polite">
        <div class="card" id="playerCard" role="region" aria-label="Player card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:900;color:var(--muted-2)">PLAYER CARD</div>
            <div style="display:flex;gap:10px">
              <button id="downloadBtn" class="icon-btn download" title="Download card" aria-label="Download card">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 3v10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M5 20h14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>

              <button id="closeBtn" class="icon-btn close" title="Close card" aria-label="Close card">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M18 6L6 18" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M6 6l12 12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
          </div>

          <div class="image-frame" style="margin-top:14px">
            <div class="image-card"><img id="avatarImg" src="pc.avif" alt="player avatar" /></div>
          </div>

          <div class="card-meta">
            <div class="meta-left">ID: <span id="playerId">(hidden)</span></div>
            <div class="status" id="statusText">Not registered</div>
          </div>

          <div class="card-tasks">
            <div class="task-row"><div class="task-left"><span class="task-dot" style="background:var(--success)"></span><div class="task-label">Complete all tasks to move up the queue</div></div></div>
            <div style="margin-top:10px" class="hint">Share your card on X to attract referrals — referrals boost your access priority.</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <canvas id="confetti" class="confetti-canvas" aria-hidden="true"></canvas>
  <div id="toast" class="toast" role="status" aria-live="polite">Copied to clipboard</div>

<script>
/* ---------- DEMO: mock "Sign in with X" (client-only) ---------- */
(function(){
  const PROVIDER_NAME = 'X';
  const LOGIN_KEY = 'mushrush.user';

  function saveUser(u){ localStorage.setItem(LOGIN_KEY, JSON.stringify(u)); }
  function loadUser(){ try{return JSON.parse(localStorage.getItem(LOGIN_KEY));}catch(e){return null;} }

  // create login button
  const loginBtn = document.createElement('button');
  loginBtn.id = 'loginX';
  loginBtn.className = 'btn-task small';
  loginBtn.textContent = 'Sign in with X';
  loginBtn.style.marginLeft = '8px';
  const headerRight = document.querySelector('.header > div[style*="margin-left:auto"]');
  if(headerRight) headerRight.insertBefore(loginBtn, headerRight.firstChild);

  // popup mock flow
  loginBtn.addEventListener('click', ()=>{
    // small centered popup
    const w = window.open('about:blank','_blank','width=520,height=640');
    if(!w){ alert('Popup blocked — allow popups'); return; }
    w.document.write(`<body style="font-family:Inter,system-ui,Arial;padding:24px;">
      <h2>Sign in with X (Demo)</h2>
      <p>Click to sign in as a demo user.</p>
      <button id="ok">Sign in</button>
      <script>
        document.getElementById('ok').addEventListener('click', ()=>{
          const user = {id:'demo-123',name:'Demo User',handle:'demo_user',avatar:''};
          // send to opener
          window.opener.postMessage({type:'mushrush.x.auth',user}, '*');
          window.close();
        });
      <\/script>
    </body>`);
  });

  // receive popup messages
  window.addEventListener('message', (ev)=>{
    try{
      if(!ev.data || ev.data.type !== 'mushrush.x.auth') return;
      const u = ev.data.user;
      saveUser(u);
      showToast('Signed in as @' + (u.handle||u.name));
      applyLoginState(u);
    }catch(e){console.error(e);}
  });

  function applyLoginState(user){
    if(!user) {
      loginBtn.textContent = 'Sign in with X';
      return;
    }
    loginBtn.textContent = 'Signed in: @' + (user.handle||user.name);
    loginBtn.classList.add('done');
    // enable register and share
    document.getElementById('registerBtn').disabled = false;
  }

  // init from localStorage
  const initial = loadUser();
  if(initial) applyLoginState(initial);

  // override register logic so it *requires* sign-in
  document.getElementById('registerBtn').addEventListener('click', (e)=>{
    const user = loadUser();
    const ref = document.getElementById('useRef').value.trim();
    if(!ref){ alert('Enter referral first'); return; }
    if(!user){ return alert('Please sign in with X first (demo)'); }
    // mark all tasks done and show congrats
    markTask('follow'); markTask('discord'); markTask('share');
    document.getElementById('statusText').innerText = 'Registered (' + (user.handle||user.name) + ')';
    showToast('Registered (demo)');
    showCongrats();
  });

  // small helper so shareOnX uses demo handle if available
  const origShare = window.shareOnX;
  window.shareOnX = function(ref){
    const u = loadUser();
    if(!u){ showToast('Sign in to share'); return; }
    // use the real web intent so user can preview
    const pageUrl = window.location.href;
    const text = `I'm on MushRush early access! Use my referral ${ref} — @${u.handle}`;
    const url = 'https://twitter.com/intent/tweet?text='+encodeURIComponent(text + ' ' + pageUrl + ' #MushRush');
    window.open(url,'_blank');
    // mark share after popup focus heuristic
    setTimeout(()=> markTask('share'), 500);
    showToast('Opening share window...');
  };

})();
</script>

</body>
</html>
